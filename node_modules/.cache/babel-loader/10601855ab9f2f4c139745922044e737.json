{"ast":null,"code":"import _regeneratorRuntime from\"/Users/lebronjames/Desktop/F21 Courses/Web Dev/TeamToffee/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/lebronjames/Desktop/F21 Courses/Web Dev/TeamToffee/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/lebronjames/Desktop/F21 Courses/Web Dev/TeamToffee/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React from\"react\";import{Card,CardActions,CardContent,CardMedia,Button,Typography}from\"@material-ui/core/\";import{Link}from\"react-router-dom\";import ThumbUpAltIcon from\"@material-ui/icons/ThumbUpAlt\";import DeleteIcon from\"@material-ui/icons/Delete\";import moment from\"moment\";import{useDispatch}from\"react-redux\";import{useEffect}from\"react\";import{votePetition,deletePetition}from\"../../../actions/petitions\";import useStyles from\"./styles\";var Petition=function Petition(_ref){var petition=_ref.petition,setCurrentId=_ref.setCurrentId;var dispatch=useDispatch();var classes=useStyles();var _React$useState=React.useState(false),_React$useState2=_slicedToArray(_React$useState,2),canDelete=_React$useState2[0],setCanDelete=_React$useState2[1];var userid=localStorage.getItem('userid');function allowToDelete(_x){return _allowToDelete.apply(this,arguments);}function _allowToDelete(){_allowToDelete=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(creator){var res,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return fetch(\"https://petition-rate.herokuapp.com/isUserAuth\",{headers:{\"x-access-token\":localStorage.getItem(\"token\")}});case 3:res=_context.sent;_context.next=6;return res.json();case 6:data=_context.sent;if(data.username===creator){setCanDelete(true);}_context.next=13;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](0);console.log(\"Error in verifying user\");case 13:case\"end\":return _context.stop();}}},_callee,null,[[0,10]]);}));return _allowToDelete.apply(this,arguments);}useEffect(function(){allowToDelete(petition.creator);},[petition]);var cardStyle={display:\"block\",width:\"100%\"};return/*#__PURE__*/React.createElement(Card,{style:cardStyle,className:classes.card},/*#__PURE__*/React.createElement(CardMedia,{className:classes.media,image:petition.selectedFile||\"https://user-images.githubusercontent.com/194400/49531010-48dad180-f8b1-11e8-8d89-1e61320e1d82.png\",title:petition.title}),/*#__PURE__*/React.createElement(\"div\",{className:classes.overlay},/*#__PURE__*/React.createElement(Typography,{variant:\"h6\"},petition.creator),/*#__PURE__*/React.createElement(Typography,{variant:\"body2\"},moment(petition.createdAt).fromNow())),/*#__PURE__*/React.createElement(\"div\",{className:classes.overlay2}),/*#__PURE__*/React.createElement(Typography,{className:classes.title,gutterBottom:true,variant:\"h5\",component:\"h2\"},petition.title),/*#__PURE__*/React.createElement(CardContent,null,/*#__PURE__*/React.createElement(Typography,{variant:\"body2\",color:\"textSecondary\",component:\"p\"},petition.message)),/*#__PURE__*/React.createElement(CardActions,{className:classes.cardActions},/*#__PURE__*/React.createElement(Button,{size:\"small\",color:\"primary\",onClick:function onClick(){return dispatch(votePetition(petition._id,userid));}},/*#__PURE__*/React.createElement(ThumbUpAltIcon,{fontSize:\"small\"}),\" Vote \",petition.voteCount,\" \"),canDelete?/*#__PURE__*/React.createElement(Button,{size:\"small\",color:\"primary\",onClick:function onClick(){return dispatch(deletePetition(petition._id));}},/*#__PURE__*/React.createElement(DeleteIcon,{fontSize:\"small\"}),\" Delete\"):null,/*#__PURE__*/React.createElement(Link,{to:\"/description/\".concat(petition._id),style:{textDecoration:\"none\"}},/*#__PURE__*/React.createElement(Button,{variant:\"outlined\",color:\"primary\"},\"Show Detail\"))));};export default Petition;","map":{"version":3,"sources":["/Users/lebronjames/Desktop/F21 Courses/Web Dev/TeamToffee/client/src/components/Petitions/Petition/Petition.js"],"names":["React","Card","CardActions","CardContent","CardMedia","Button","Typography","Link","ThumbUpAltIcon","DeleteIcon","moment","useDispatch","useEffect","votePetition","deletePetition","useStyles","Petition","petition","setCurrentId","dispatch","classes","useState","canDelete","setCanDelete","userid","localStorage","getItem","allowToDelete","creator","fetch","headers","res","json","data","username","console","log","cardStyle","display","width","card","media","selectedFile","title","overlay","createdAt","fromNow","overlay2","message","cardActions","_id","voteCount","textDecoration"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport {\n  Card,\n  CardActions,\n  CardContent,\n  CardMedia,\n  Button,\n  Typography,\n} from \"@material-ui/core/\";\nimport { Link } from \"react-router-dom\";\nimport ThumbUpAltIcon from \"@material-ui/icons/ThumbUpAlt\";\nimport DeleteIcon from \"@material-ui/icons/Delete\";\nimport moment from \"moment\";\nimport { useDispatch } from \"react-redux\";\nimport { useEffect } from \"react\";\n\nimport { votePetition, deletePetition } from \"../../../actions/petitions\";\nimport useStyles from \"./styles\";\n\nconst Petition = ({ petition, setCurrentId }) => {\n  const dispatch = useDispatch();\n  const classes = useStyles();\n  const [canDelete, setCanDelete] = React.useState(false);\n  const userid = localStorage.getItem('userid');\n\n  async function allowToDelete(creator) {\n    try {\n      const res = await fetch(\"https://petition-rate.herokuapp.com/isUserAuth\", {\n        headers: {\n          \"x-access-token\": localStorage.getItem(\"token\"),\n        },\n      });\n\n      const data = await res.json();\n\n      if (data.username === creator) {\n        setCanDelete(true);\n      }\n    } catch (err) {\n      console.log(\"Error in verifying user\");\n    }\n  }\n\n  useEffect(() => {\n    allowToDelete(petition.creator)\n  }, [petition]);\n\n  const cardStyle = {\n    display: \"block\",\n    width: \"100%\"\n  };\n\n  return (\n    <Card style={cardStyle} className={classes.card}>\n      <CardMedia\n        className={classes.media}\n        image={\n          petition.selectedFile ||\n          \"https://user-images.githubusercontent.com/194400/49531010-48dad180-f8b1-11e8-8d89-1e61320e1d82.png\"\n        }\n        title={petition.title}\n      />\n      <div className={classes.overlay}>\n        <Typography variant=\"h6\">{petition.creator}</Typography>\n        <Typography variant=\"body2\">\n          {moment(petition.createdAt).fromNow()}\n        </Typography>\n      </div>\n      <div className={classes.overlay2}>\n\n      </div>\n      <Typography\n        className={classes.title}\n        gutterBottom\n        variant=\"h5\"\n        component=\"h2\"\n      >\n        {petition.title}\n      </Typography>\n      <CardContent>\n        <Typography variant=\"body2\" color=\"textSecondary\" component=\"p\">\n          {petition.message}\n        </Typography>\n      </CardContent>\n      <CardActions className={classes.cardActions}>\n        <Button\n          size=\"small\"\n          color=\"primary\"\n          onClick={() => dispatch(votePetition(petition._id, userid))}\n        >\n          <ThumbUpAltIcon fontSize=\"small\" /> Vote {petition.voteCount}{\" \"}\n        </Button>\n\n        {canDelete ? (\n          <Button\n            size=\"small\"\n            color=\"primary\"\n            onClick={() => dispatch(deletePetition(petition._id))}\n          >\n            <DeleteIcon fontSize=\"small\" /> Delete\n          </Button>\n        ) : null}\n        <Link\n          to={`/description/${petition._id}`}\n          style={{ textDecoration: \"none\" }}\n        >\n          <Button variant=\"outlined\" color=\"primary\">\n            Show Detail\n          </Button>\n        </Link>\n      </CardActions>\n\n    </Card>\n  );\n};\n\nexport default Petition;\n"]},"metadata":{},"sourceType":"module"}