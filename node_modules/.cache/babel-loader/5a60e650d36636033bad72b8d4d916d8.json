{"ast":null,"code":"import _regeneratorRuntime from\"/Users/lebronjames/Desktop/F21 Courses/Web Dev/TeamToffee/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/lebronjames/Desktop/F21 Courses/Web Dev/TeamToffee/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/lebronjames/Desktop/F21 Courses/Web Dev/TeamToffee/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import*as React from\"react\";import{useHistory}from\"react-router-dom\";import{useEffect,useState}from\"react\";import\"./Signin.css\";import{Avatar,Button,Grow}from\"@material-ui/core\";import CssBaseline from\"@material-ui/core/CssBaseline\";import TextField from\"@material-ui/core/TextField\";import Link from\"@material-ui/core/Link\";import Grid from\"@material-ui/core/Grid\";import Box from\"@material-ui/core/Box\";import Typography from\"@material-ui/core/Typography\";import Container from\"@material-ui/core/Container\";import ResponsiveAppBar from\"./../NavigationBar/ResponsiveAppBar\";var SignIn=function SignIn(){var history=useHistory();var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),ErrMessage=_useState2[0],SetErrMessage=_useState2[1];function verifyAndLoggingIn(){return _verifyAndLoggingIn.apply(this,arguments);}function _verifyAndLoggingIn(){_verifyAndLoggingIn=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return fetch(\"https://petition-rate.herokuapp.com/isUserAuth\",{headers:{\"x-access-token\":localStorage.getItem(\"token\")}});case 3:res=_context.sent;_context.next=6;return res.json();case 6:data=_context.sent;if(data.isLoggedIn){localStorage.setItem(\"userid\",data.userid);history.push(\"/home\");}else{}_context.next=13;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](0);console.log(\"Error in verifying user\");case 13:case\"end\":return _context.stop();}}},_callee,null,[[0,10]]);}));return _verifyAndLoggingIn.apply(this,arguments);}function handleSubmit(_x){return _handleSubmit.apply(this,arguments);}function _handleSubmit(){_handleSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(event){var data,user,res,_data;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:event.preventDefault();data=new FormData(event.currentTarget);user={username:data.get(\"email\"),password:data.get(\"password\")};_context2.prev=3;_context2.next=6;return fetch(\"https://petition-rate.herokuapp.com/signin\",{method:\"POST\",headers:{\"Content-type\":\"application/json\"},body:JSON.stringify(user)});case 6:res=_context2.sent;_context2.next=9;return res.json();case 9:_data=_context2.sent;if(_data.message==\"Invalid username or password.\"){SetErrMessage(\"Invalid username or password.\");}localStorage.setItem(\"token\",_data.token);_context2.next=14;return verifyAndLoggingIn();case 14:_context2.next=19;break;case 16:_context2.prev=16;_context2.t0=_context2[\"catch\"](3);console.log(\"Error. No such user\");case 19:case\"end\":return _context2.stop();}}},_callee2,null,[[3,16]]);}));return _handleSubmit.apply(this,arguments);}useEffect(function(){verifyAndLoggingIn();},[]);var routeChangeToSignUp=function routeChangeToSignUp(){history.push(\"/signup\");};return/*#__PURE__*/ (// <ThemeProvider theme={theme}>\nReact.createElement(\"div\",null,/*#__PURE__*/React.createElement(ResponsiveAppBar,null),/*#__PURE__*/React.createElement(Grow,{in:true},/*#__PURE__*/React.createElement(Container,{component:\"main\",maxWidth:\"xs\",style:{\"margin-top\":\"150px\"}},/*#__PURE__*/React.createElement(CssBaseline,null),/*#__PURE__*/React.createElement(Box,{sx:{marginTop:8,display:\"flex\",flexDirection:\"column\",alignItems:\"center\"}},/*#__PURE__*/React.createElement(Avatar,{sx:{m:1,bgcolor:\"secondary.main\"}}),/*#__PURE__*/React.createElement(Typography,{component:\"h1\",variant:\"h5\"},\"Sign in\"),/*#__PURE__*/React.createElement(Box,{component:\"form\",onSubmit:handleSubmit,noValidate:true,sx:{mt:1}},/*#__PURE__*/React.createElement(TextField,{margin:\"normal\",required:true,fullWidth:true,id:\"email\",label:\"Username\",name:\"email\",autoComplete:\"email\",autoFocus:true}),/*#__PURE__*/React.createElement(TextField,{margin:\"normal\",required:true,fullWidth:true,name:\"password\",label:\"Password\",type:\"password\",id:\"password\",autoComplete:\"current-password\"}),/*#__PURE__*/React.createElement(Button,{type:\"submit\",fullWidth:true,variant:\"contained\",sx:{mt:3,mb:2}},\"Sign In\"),ErrMessage==\"\"?/*#__PURE__*/React.createElement(\"p\",{className:\"normal_message\"},\"Please Sign In\"):/*#__PURE__*/React.createElement(\"p\",{className:\"error_message\"},ErrMessage),/*#__PURE__*/React.createElement(Grid,{container:true},/*#__PURE__*/React.createElement(Grid,{item:true},/*#__PURE__*/React.createElement(Link,{href:\"#\",variant:\"body2\",onClick:routeChangeToSignUp},\"Don't have an account? Sign Up\")))))))));};export default SignIn;","map":{"version":3,"sources":["/Users/lebronjames/Desktop/F21 Courses/Web Dev/TeamToffee/client/src/components/SignUp/Signin.js"],"names":["React","useHistory","useEffect","useState","Avatar","Button","Grow","CssBaseline","TextField","Link","Grid","Box","Typography","Container","ResponsiveAppBar","SignIn","history","ErrMessage","SetErrMessage","verifyAndLoggingIn","fetch","headers","localStorage","getItem","res","json","data","isLoggedIn","setItem","userid","push","console","log","handleSubmit","event","preventDefault","FormData","currentTarget","user","username","get","password","method","body","JSON","stringify","message","token","routeChangeToSignUp","marginTop","display","flexDirection","alignItems","m","bgcolor","mt","mb"],"mappings":"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","sourcesContent":["import * as React from \"react\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport { useEffect, useState } from \"react\";\r\nimport \"./Signin.css\"\r\nimport { Avatar, Button, Grow } from \"@material-ui/core\";\r\nimport CssBaseline from \"@material-ui/core/CssBaseline\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport Link from \"@material-ui/core/Link\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport Container from \"@material-ui/core/Container\";\r\nimport ResponsiveAppBar from \"./../NavigationBar/ResponsiveAppBar\";\r\n\r\nconst SignIn = () => {\r\n  const history = useHistory();\r\n  const [ErrMessage, SetErrMessage] = useState(\"\")\r\n  async function verifyAndLoggingIn() {\r\n    try {\r\n      const res = await fetch(\"https://petition-rate.herokuapp.com/isUserAuth\", {\r\n        headers: {\r\n          \"x-access-token\": localStorage.getItem(\"token\"),\r\n        },\r\n      });\r\n\r\n      const data = await res.json();\r\n      if (data.isLoggedIn) {\r\n        localStorage.setItem(\"userid\", data.userid);\r\n        history.push(\"/home\");\r\n      }else{\r\n\r\n      }\r\n    } catch (err) {\r\n      console.log(\"Error in verifying user\");\r\n    }\r\n  }\r\n\r\n  async function handleSubmit(event) {\r\n    event.preventDefault();\r\n    const data = new FormData(event.currentTarget);\r\n    const user = {\r\n      username: data.get(\"email\"),\r\n      password: data.get(\"password\"),\r\n    };\r\n\r\n    try {\r\n      const res = await fetch(\"https://petition-rate.herokuapp.com/signin\", {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify(user),\r\n      });\r\n      const data = await res.json();\r\n      if(data.message == \"Invalid username or password.\"){\r\n        SetErrMessage(\"Invalid username or password.\")\r\n      }\r\n      localStorage.setItem(\"token\", data.token);\r\n\r\n      await verifyAndLoggingIn();\r\n\r\n      // history.push(\"/\");\r\n\r\n      // console.log(\"Get token: \", localStorage.getItem(\"token\"));\r\n    } catch (err) {\r\n      console.log(\"Error. No such user\");\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    verifyAndLoggingIn();\r\n  }, []);\r\n\r\n  const routeChangeToSignUp = () => {\r\n    history.push(\"/signup\");\r\n  };\r\n\r\n  return (\r\n    // <ThemeProvider theme={theme}>\r\n    <div>\r\n      <ResponsiveAppBar />\r\n      <Grow in>\r\n        <Container\r\n          component=\"main\"\r\n          maxWidth=\"xs\"\r\n          style={{ \"margin-top\": \"150px\" }}\r\n        >\r\n          <CssBaseline />\r\n          <Box\r\n            sx={{\r\n              marginTop: 8,\r\n              display: \"flex\",\r\n              flexDirection: \"column\",\r\n              alignItems: \"center\",\r\n            }}\r\n          >\r\n            <Avatar sx={{ m: 1, bgcolor: \"secondary.main\" }}></Avatar>\r\n            <Typography component=\"h1\" variant=\"h5\">\r\n              Sign in\r\n            </Typography>\r\n            <Box\r\n              component=\"form\"\r\n              onSubmit={handleSubmit}\r\n              noValidate\r\n              sx={{ mt: 1 }}\r\n            >\r\n              <TextField\r\n                margin=\"normal\"\r\n                required\r\n                fullWidth\r\n                id=\"email\"\r\n                label=\"Username\"\r\n                name=\"email\"\r\n                autoComplete=\"email\"\r\n                autoFocus\r\n              />\r\n              <TextField\r\n                margin=\"normal\"\r\n                required\r\n                fullWidth\r\n                name=\"password\"\r\n                label=\"Password\"\r\n                type=\"password\"\r\n                id=\"password\"\r\n                autoComplete=\"current-password\"\r\n              />\r\n              <Button\r\n                type=\"submit\"\r\n                fullWidth\r\n                variant=\"contained\"\r\n                sx={{ mt: 3, mb: 2 }}\r\n              >\r\n                Sign In\r\n              </Button>\r\n              {ErrMessage == \"\" ? (\r\n                  <p className=\"normal_message\">Please Sign In</p>\r\n              ) : (<p className=\"error_message\">{ErrMessage}</p>)\r\n              }\r\n              <Grid container>\r\n                <Grid item>\r\n                  <Link href=\"#\" variant=\"body2\" onClick={routeChangeToSignUp}>\r\n                    {\"Don't have an account? Sign Up\"}\r\n                  </Link>\r\n                </Grid>\r\n              </Grid>\r\n            </Box>\r\n          </Box>\r\n        </Container>\r\n      </Grow>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default SignIn;\r\n"]},"metadata":{},"sourceType":"module"}